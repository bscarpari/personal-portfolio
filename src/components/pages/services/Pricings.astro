---
import { getLangFromUrl, useTranslations } from "@/i18n/utils";

const lang = getLangFromUrl(Astro.url) as "en" | "br";
const t = useTranslations(lang);

const plans = [
  {
    medal: "bronze",
    title: `${t("services.pricing.first.plan")}`,
    price: `${t("services.pricing.first.plan.price")}`,
    deliveryTime: `${t("services.pricing.first.plan.deliveryTime")}`,
    features: [
      `${t("services.pricing.second.plan.features.first")}`,
      `${t("services.pricing.second.plan.features.second")}`,
      `${t("services.pricing.second.plan.features.third")}`,
      `${t("services.pricing.second.plan.features.fourth")}`,
      `${t("services.pricing.second.plan.features.fifth")}`,
    ],
    whatsappText: "simple",
  },
  {
    medal: "silver",
    title: `${t("services.pricing.second.plan")}`,
    price: `${t("services.pricing.second.plan.price")}`,
    deliveryTime: `${t("services.pricing.second.plan.deliveryTime")}`,
    features: [
      `${t("services.pricing.second.plan.features.first")}`,
      `${t("services.pricing.second.plan.features.second")}`,
      `${t("services.pricing.second.plan.features.third")}`,
      `${t("services.pricing.second.plan.features.fourth")}`,
      `${t("services.pricing.second.plan.features.fifth")}`,
    ],
    whatsappText: "intermediate",
    recommend: true,
  },
  {
    medal: "gold",
    title: `${t("services.pricing.third.plan")}`,
    price: `${t("services.pricing.third.plan.price")}`,
    deliveryTime: `${t("services.pricing.third.plan.deliveryTime")}`,
    features: [
      `${t("services.pricing.third.plan.features.first")}`,
      `${t("services.pricing.third.plan.features.second")}`,
      `${t("services.pricing.third.plan.features.third")}`,
      `${t("services.pricing.third.plan.features.fourth")}`,
      `${t("services.pricing.third.plan.features.fifth")}`,
      `${t("services.pricing.third.plan.features.sixth")}`,
    ],
    whatsappText: "advanced",
  },
];
---

<div id="pricings">
  <div class="relative">
    <div
      class="relative mx-auto max-w-2xl px-6 py-24 lg:max-w-7xl lg:px-8 lg:py-32 text-center"
    >
      <div class="relative">
        <h1
          class="mt-4 text-3xl sm:text-4xl font-bold tracking-tight text-primary-foreground"
        >
          {t("services.pricing.title")}<span class="relative">
            {t("services.pricing.highlight")}
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="194"
              height="10"
              viewBox="0 0 194 10"
              fill="none"
              class="absolute bottom-0 left-0 right-0 w-[120px] mx-auto"
            >
              <path
                d="M193.218 8.45984C182.152 7.68936 171.09 6.8475 160.024 6.17276C153.258 5.76543 146.478 5.54845 139.704 5.36377C133.478 5.19332 127.248 5.07045 121.016 5.10679C110.908 5.16822 100.789 5.15716 90.6978 5.55452C63.6708 6.60596 36.6622 7.85792 9.64414 9.01358C7.68516 9.10037 5.60993 9.46601 3.80591 8.94986C2.45303 8.56078 0.863993 7.15895 0.429225 5.86938C-0.246066 3.86167 1.34615 3.01608 3.35055 2.97231C14.7483 2.69781 26.15 2.36781 37.5547 2.10973C58.8208 1.62163 80.0833 1.06948 101.354 0.749067C110.757 0.606706 120.187 0.777053 129.585 1.18422C132.762 1.32576 135.939 1.48317 139.126 1.6094C141.862 1.72019 144.634 2.82971 147.284 2.54401C151.236 2.11774 154.91 3.93574 158.649 3.55839C163.671 3.05522 168.347 4.63207 173.206 4.96241C178.315 5.30215 183.43 5.67419 188.526 6.18843C190.185 6.35969 191.794 7.01368 193.426 7.45407C193.362 7.78441 193.298 8.12268 193.234 8.46095L193.218 8.45984Z"
                fill="url(#paint0_linear_319_246)"></path>
              <defs>
                <linearGradient
                  id="paint0_linear_319_246"
                  x1="0.585853"
                  y1="0.413877"
                  x2="192.983"
                  y2="13.8087"
                  gradientUnits="userSpaceOnUse"
                >
                  <stop stop-color="#C082FF"></stop>
                  <stop offset="1" stop-color="#7E67FF"></stop>
                </linearGradient>
              </defs>
            </svg>
          </span>
        </h1>
        <p class="mt-6 text-xl" set:html={t("services.pricing.description")} />
      </div>
    </div>
  </div>
  <main>
    <section class="relative" aria-labelledby="pricing-heading">
      <h2 id="pricing-heading" class="sr-only">Pricing</h2>

      <div
        class="mx-auto max-w-2xl space-y-12 px-6 lg:grid lg:max-w-7xl lg:grid-cols-3 lg:gap-x-8 lg:space-y-0 lg:px-8"
        id="pricing-plans"
      >
        {
          plans.map((plan) => (
            <div
              class={`h-full rounded-2xl py-[0.85px] px-[0.75px] transform transition-transform duration-300 hover:-translate-y-2 ${
                plan.recommend ? "bg-gradient" : ""
              }`}
            >
              <div
                class={`relative flex flex-col rounded-2xl p-8 shadow-sm bg-[#121217] h-full`}
              >
                <div class="flex-1">
                  <img
                    src={`/assets/medals/${plan.medal}.svg`}
                    alt={`${plan.title} Medal`}
                    class="absolute top-8 -right-8 -translate-y-1/2 transform w-32 h-32 object-cover"
                  />
                  <h3 class="text-xl font-semibold text-primary-foreground">
                    {plan.title}
                  </h3>
                  {plan.recommend && (
                    <p class="absolute top-0 -translate-y-1/2 transform rounded-full bg-gradient px-4 py-1.5 text-sm font-semibold text-white uppercase">
                      {t("services.pricing.recommended")}
                    </p>
                  )}
                  <p class="mt-4 flex items-baseline text-primary-foreground">
                    <span class="text-2xl sm:text-3xl md:text-4xl lg:text-4xl font-bold tracking-tight">
                      {plan.price}
                    </span>
                  </p>
                  <p class="mt-6">{plan.deliveryTime}</p>

                  <ul role="list" class="mt-6 space-y-6">
                    {plan.features.map((feature) => (
                      <li class="flex">
                        <svg
                          class="h-6 w-6 flex-shrink-0 text-gradientbg-gradient"
                          fill="none"
                          viewBox="0 0 24 24"
                          stroke-width="1.5"
                          stroke="currentColor"
                          aria-hidden="true"
                        >
                          <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            d="M4.5 12.75l6 6 9-13.5"
                          />
                        </svg>
                        <span class="ml-3">{feature}</span>
                      </li>
                    ))}
                  </ul>
                </div>

                <a
                  href={`https://wa.me/${
                    import.meta.env.WHATSAPP_NUMBER
                  }?text=${encodeURIComponent(
                    `${t("services.pricing.whatsappMessage")}${t(
                      `services.pricing.type.${plan.whatsappText}`
                    )}`
                  )}`}
                  class={`mt-8 block w-full rounded-md border border-transparent py-3 px-6 text-center font-medium ${
                    plan.recommend
                      ? "bg-gradient text-white hover:opacity-80"
                      : "bg-secondary text-primary hover:opacity-70"
                  }`}
                >
                  {t("services.pricing.cta")}
                </a>
              </div>
            </div>
          ))
        }
      </div>
    </section>
  </main>
</div>
